# System Knowledge Graph: Overpowers Toolkit

> **Status**: Living Document (Updated: 2026-05-24)
> **Purpose**: The "Cognitive Context File" for the Overpowers Agentic System.
> **Source of Truth**: Combined analysis of source code, `AGENTS.md`, and `JULES_ARCHITECTURAL_DIGEST.md`.

## 1. Topography & Inventory

### Core Stats (Verified)
| Component | Count (Approx) | Location | Description |
|-----------|----------------|----------|-------------|
| **Agents** | ~449 | `agents/` | Specialized AI personas defined in Markdown frontmatter. |
| **Skills** | ~207 | `skills/` | Modular capabilities (Python/Node/Bash) wrapped in `SKILL.md`. |
| **Commands** | ~230 | `commands/` | Shorthand operations for common tasks. |
| **Hooks** | ~29 | `hooks/` | Event-driven triggers (pre/post-commit, safety). |
| **Scripts** | ~90 | `scripts/` | DevOps and automation helpers. |
| **Workflows** | ~21 | `workflows/` | Documented multi-step processes. |

### Key Directories
*   `agents/`: Source of truth for all agent definitions.
*   `skills/`: Library of executable capabilities.
*   `commands/`: User-facing CLI shortcuts.
*   `hooks/`: System integrity and safety enforcement.
*   `scripts/`: Automation and maintenance tools.
*   `config/`: Generated JSON configurations for the runtime.
*   `docs/`: Extensive documentation and knowledge base.
*   `packages/jules-swarm/`: Submodule for distributed agent orchestration.

## 2. High-Level Architecture Diagram

```mermaid
graph TD
    User[User / Developer] -->|CLI Commands| OpenCode[OpenCode / Claude Code CLI]
    OpenCode -->|Loads| Config[Agent Configuration (JSON)]

    subgraph "Core Orchestration"
        CEO[CEO Orchestrator] -->|Delegates| Sisyphus[Sisyphus Planner]
        CEO -->|Delegates| Metis[Metis Consultant]
        Sisyphus -->|Assigns| SubAgents[Specialist Agents]
    end

    subgraph "Agent Army (449+)"
        SubAgents -->|Uses| Skills[Skills Library (207+)]
        SubAgents -->|Uses| Scripts[Helper Scripts]
    end

    subgraph "Jules Swarm (Distributed)"
        JulesLauncher[Swarm Launcher] -->|API| JulesAPI[Jules API]
        JulesAPI -->|Spawns| RemoteSessions[Remote Agent Sessions]
        RemoteSessions -->|Commit| GitHub[GitHub Repository]
    end

    subgraph "Compound Product Cycle"
        Report[Report.md] -->|Input| AutoCompound[auto-compound.sh]
        AutoCompound -->|Generates| PRD[PRD & Tasks]
        PRD -->|Loop| Loop[loop.sh]
        Loop -->|Code/Verify| Codebase
        Loop -->|Push| PR[Pull Request]
    end

    OpenCode --> CEO
    SubAgents -.->|Dispatch| JulesLauncher
    Config -.->|Generated By| GenScript[generate-agent-configs.py]

    %% Safety Layer
    Hooks[Safety Hooks] --|Intercept| ShellCommands[Shell Execution]
    ShellCommands -->|Block/Allow| System
```

## 3. Entity-Relationship Model

*   **Agent**: Defined in `agents/*.md`.
    *   *Has*: Name, Description, Category, Prompt (System Instruction).
    *   *Uses*: Skills, Scripts.
    *   *Generated Into*: `config/agents/*.json` via `generate-agent-configs.py`.
*   **Skill**: Defined in `skills/*/SKILL.md`.
    *   *Contains*: Instructions, Executable Code (Python/Node/Bash), Assets.
    *   *Used By*: Agents to perform specific actions (e.g., "Web Research", "Code Analysis").
*   **Workflow**: Defined in `workflows/*.md`.
    *   *Describes*: A sequence of steps for complex goals.
    *   *Orchestrates*: Multiple Agents (e.g., "Security Hardening").
*   **Hook**: Defined in `hooks/`.
    *   *Triggered By*: System events (Pre-Command, Post-Commit).
    *   *Enforces*: Safety (`destructive-command-blocker`), Formatting, Notifications.
*   **Swarm Session**: Managed by `packages/jules-swarm`.
    *   *Represents*: A remote, parallel execution unit.
    *   *Context*: Git Repository + Task.

## 4. Component Registry

| Component Group | Key Path | Responsibility |
|---|---|---|
| **Root Constitution** | `AGENTS.md` | Defines Operational Laws, Protocols, and Routing Table. |
| **Architecture Doc** | `JULES_ARCHITECTURAL_DIGEST.md` | High-level system design and critical paths. |
| **Agent Generator** | `generate-agent-configs.py` | Compiles Markdown agents into CLI-compatible JSON config. |
| **Compound Cycle** | `scripts/compound/auto-compound.sh` | Automates the "Report -> PRD -> Code -> PR" product lifecycle. |
| **Swarm Core** | `packages/jules-swarm/` | Python submodule for managing distributed agent swarms via Jules API. |
| **Safety Guard** | `hooks/safety/destructive-command-blocker.ts` | Prevents catastrophic shell commands (`rm -rf /`, `mkfs`, etc.). |
| **Inventory Script** | `generate-inventory.py` | Generates markdown inventory of all assets (Agents, Skills, Scripts). |
| **Deployment Script** | `deploy-agent-army.sh` | Master script to regenerate configs and inject them into the runtime. |
| **Agents Library** | `agents/` | Source of truth for all 449+ agents. |
| **Skills Library** | `skills/` | Source of truth for all 207+ skills. |

## 5. Operational Protocols (Must Obey)

### Protocol Zero (The Session Ledger)
*   **Rule**: Every session MUST start by reading `continuity.md` and end by updating it.
*   **Purpose**: Maintains context across stateless agent sessions.
*   **Action**: Read `continuity.md` -> Align -> Work -> Update `continuity.md`.

### The Changelog Law
*   **Rule**: Every code modification MUST have a corresponding entry in `CHANGELOG.md`.
*   **Format**: Top of file, descending date.
*   **Constraint**: Never delete history.

### The Law of Explicit Declaration
*   **Rule**: Agents are not visible to the system until `generate-agent-configs.py` is run and the config is reloaded.

### Safety Constraints
*   **Forbidden**: `rm -rf /`, `rm -rf ~`, `mkfs`, `dd` to physical devices.
*   **Secrets**: Never commit API keys. Use `1password` skill or env vars.
*   **Versioning**: Do not change package versions without explicit instruction.

## 6. Health of the Codebase (Analysis)

### Observations
*   **Scale**: The codebase is massive (449+ agents, 207+ skills), indicating a high degree of specialization but potential for fragmentation.
*   **Architecture**: The separation between "Definition" (Markdown) and "Runtime" (JSON/Python) is clean and allows for easy extension.
*   **Automation**: The "Compound Product Cycle" and "Jules Swarm" indicate a high level of self-replication and autonomous capability.
*   **Documentation**: Documentation is extensive and seemingly up-to-date with the code structure.

### Discrepancies / Technical Debt
*   **Count Mismatch**: `README.md` and `AGENTS.md` report outdated counts (~390 agents vs 449 actual, ~149 skills vs 207 actual).
*   **Legacy Paths**: `generate-inventory.py` contains hardcoded paths (`/home/sephiroth/...`) which may fail in other environments.
*   **Duplication**: Some agent definitions (e.g., `sisyphus`) appear in multiple locations (`agents/` vs `agents/sisyphus/`), possibly due to legacy vs. modular organization.
*   **Complexity**: The sheer number of files makes manual navigation difficult; reliance on tooling (`generate-inventory.py`, `explore-grep`) is essential.

## 7. Knowledge Graph (Concepts)

*   **PREVC Workflow**: Planning -> Review -> Execution -> Validation -> Confirmation.
*   **Micode Architecture**: Brainstorm -> Plan -> Implement (with "Mindmodel" and "Ledger").
*   **Ralph Loop**: Autonomous recursive task execution.
*   **Overpowers**: The consolidated toolkit itself, forked from Superpowers.
